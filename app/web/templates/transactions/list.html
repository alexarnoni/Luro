{% extends "base.html" %}

{% block title %}Transactions - Luro{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Transactions</h1>
    <button onclick="toggleForm()" class="btn btn-primary">+ Add Transaction</button>
</div>

<div id="transaction-form" class="form-card" style="display: none;">
    <h2>Add New Transaction</h2>
    <form method="post" action="/transactions">
        <div class="form-group">
            <label for="account_id">Account</label>
            <select id="account_id" name="account_id" required class="form-control">
                <option value="">Select an account</option>
                {% for account in accounts %}
                <option value="{{ account.id }}">{{ account.name }}</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="form-group">
            <label for="transaction_type">Type</label>
            <select id="transaction_type" name="transaction_type" required class="form-control">
                <option value="income">Income</option>
                <option value="expense">Expense</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="amount">Amount</label>
            <input type="number" id="amount" name="amount" step="0.01" required class="form-control" placeholder="0.00">
        </div>
        
        <div class="form-group">
            <label for="category">Category</label>
            <input type="text" id="category" name="category" class="form-control" placeholder="e.g., Groceries, Salary">
        </div>
        
        <div class="form-group">
            <label for="description">Description</label>
            <input type="text" id="description" name="description" class="form-control" placeholder="Optional description">
        </div>
        
        <div class="form-group">
            <label for="transaction_date">Date</label>
            <input type="datetime-local" id="transaction_date" name="transaction_date" class="form-control">
        </div>
        
        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Add Transaction</button>
            <button type="button" onclick="toggleForm()" class="btn btn-secondary">Cancel</button>
        </div>
    </form>
</div>

<div class="transactions-table">
    {% if transactions %}
    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Account</th>
                <th>Type</th>
                <th>Category</th>
                <th>Description</th>
                <th>Amount</th>
            </tr>
        </thead>
        <tbody>
            {% for transaction in transactions %}
            <tr>
                <td>{{ transaction.transaction_date.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>{{ transaction.account.name }}</td>
                <td><span class="badge badge-{{ transaction.transaction_type }}">{{ transaction.transaction_type|title }}</span></td>
                <td>{{ transaction.category or '-' }}</td>
                <td>{{ transaction.description or '-' }}</td>
                <td class="{% if transaction.transaction_type == 'income' %}positive{% else %}negative{% endif %}">
                    {% if transaction.transaction_type == 'income' %}+{% else %}-{% endif %}${{ "%.2f"|format(transaction.amount) }}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>No transactions yet. Add your first transaction to get started!</p>
    {% endif %}
</div>

<script>
function toggleForm() {
    const form = document.getElementById('transaction-form');
    form.style.display = form.style.display === 'none' ? 'block' : 'none';
}
</script>
{% endblock %}
